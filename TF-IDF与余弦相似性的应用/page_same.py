#   用TF-IDF结合余弦相似性，衡量文档之间的相似程度
#http://www.ruanyifeng.com/blog/2013/03/cosine_similarity.html
import get_word
import numpy as np
import math,time




def start(name_1,name_2):
    result_1 = get_word.main(name_1,50)  #取50个关键字
    result_2 = get_word.main(name_2,50)
    # result_1 = [('桑桑', 0.09660701134931857), ('桑乔', 0.02915265201266565), ('细马', 0.026513476173306908), ('一轮', 0.020055719131004988), ('油麻', 0.01883491301994846), ('白雀', 0.017426727547800083), ('小康', 0.015478688773362725), ('一个', 0.014333365542655426), ('没有', 0.014279320905772752), ('秦大', 0.01183025879034641), ('二妈', 0.010152853846476765), ('孩子', 0.009409980650953867), ('奶奶', 0.007339895614926665), ('二爷', 0.006537717867926663), ('他们', 0.006292388277233588), ('看到', 0.006034972393164941), ('起来', 0.005548742389924164), ('母亲', 0.0055201406250276475), ('觉得', 0.005205521211165968), ('自己', 0.005033910621786871), ('什么', 0.004976707091993837), ('父亲', 0.004601758942130415), ('小学', 0.004461875323856545), ('一边', 0.0037861169029348067), ('老师', 0.003775432966340153), ('样子', 0.003746831201443637), ('这个', 0.0037182294365471205), ('坐在', 0.0036929916421627163), ('然后', 0.0036896276716506036), ('知道', 0.003546618847168022), ('就是', 0.003360971671017797), ('一片', 0.003198684106446259), ('过来', 0.003146194138616794), ('那个', 0.003146194138616794), ('教室', 0.003088727565470577), ('一只', 0.003060388843927245), ('仿佛', 0.0030062920483388458), ('因为', 0.0029459817843411795), ('还是', 0.002860176489651631), ('它们', 0.002774371194962082), ('地方', 0.002602760605582984), ('之后', 0.0024883535459969187), ('似乎', 0.0024733019406370745), ('已经', 0.0024597517811004027), ('一样', 0.0024311500162038863), ('心里', 0.0024311500162038863), ('一下', 0.00240254825130737), ('出来', 0.002373946486410854), ('眼睛', 0.002316742956617821), ('一直', 0.002316742956617821)]
    # result_2 = [('桑桑', 0.09660701134931857), ('桑乔', 0.02915265201266565), ('细马', 0.026513476173306908), ('一轮', 0.020055719131004988), ('油麻', 0.01883491301994846), ('白雀', 0.017426727547800083), ('小康', 0.015478688773362725), ('一个', 0.014333365542655426), ('没有', 0.014279320905772752), ('秦大', 0.01183025879034641), ('二妈', 0.010152853846476765), ('孩子', 0.009409980650953867), ('奶奶', 0.007339895614926665), ('二爷', 0.006537717867926663), ('他们', 0.006292388277233588), ('看到', 0.006034972393164941), ('起来', 0.005548742389924164), ('母亲', 0.0055201406250276475), ('觉得', 0.005205521211165968), ('自己', 0.005033910621786871), ('什么', 0.004976707091993837), ('父亲', 0.004601758942130415), ('小学', 0.004461875323856545), ('一边', 0.0037861169029348067), ('老师', 0.003775432966340153), ('样子', 0.003746831201443637), ('这个', 0.0037182294365471205), ('坐在', 0.0036929916421627163), ('然后', 0.0036896276716506036), ('知道', 0.003546618847168022), ('就是', 0.003360971671017797), ('一片', 0.003198684106446259), ('过来', 0.003146194138616794), ('那个', 0.003146194138616794), ('教室', 0.003088727565470577), ('一只', 0.003060388843927245), ('仿佛', 0.0030062920483388458), ('因为', 0.0029459817843411795), ('还是', 0.002860176489651631), ('它们', 0.002774371194962082), ('地方', 0.002602760605582984), ('之后', 0.0024883535459969187), ('似乎', 0.0024733019406370745), ('已经', 0.0024597517811004027), ('一样', 0.0024311500162038863), ('心里', 0.0024311500162038863), ('一下', 0.00240254825130737), ('出来', 0.002373946486410854), ('眼睛', 0.002316742956617821), ('一直', 0.002316742956617821)]

    xiangliang_1 = []  #存放向量值
    xiangliang_2 = []
    for i in result_1:
        xiangliang_1.append(i[1])
    for j in result_2:
        xiangliang_2.append(j[1])
    arr1 = np.array(xiangliang_1)  #转换成数组
    arr2 = np.array(xiangliang_2)

    M = (arr1 * arr2).sum()  #文本1向量 乘以 文本2向量 的和
    A1 = (arr1 * arr1).sum() #文本1向量平方 的和
    A2 = (arr2 * arr2).sum() #文本2向量平方 的和
    F = math.sqrt(A1) * math.sqrt(A2) #
    cos_num = M / F
    print('M:',M)
    print('A1:',A1)
    print("A2:",A2)
    print('F:',F)
    print('cos_num:',cos_num)


name_1 = '《草房子》完整版.txt'
name_2 = '梦里花落知多少.txt'

start_time = time.time()
start(name_1,name_2)
print("共计耗时：%s",time.time()-start_time())